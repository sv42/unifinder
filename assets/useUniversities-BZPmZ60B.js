import{a as o}from"./chunk-EF7DTUVF-DePYFLeH.js";import{s}from"./supabase-CvHotojb.js";function B(){const[y,u]=o.useState([]),[c,n]=o.useState(!1),[m,i]=o.useState(null),f=o.useCallback(async()=>{if(!c){n(!0),i(null);try{const{data:t,error:e}=await s.from("universities").select("*").order("name");if(e)throw e;u(t||[])}catch(t){console.error("Помилка завантаження університетів:",t),i(t.message)}finally{n(!1)}}},[c]),d=o.useCallback(async t=>{n(!0),i(null);try{let e=s.from("universities").select("*");if(t.query&&(e=e.ilike("name",`%${t.query}%`)),t.country&&(e=e.eq("country",t.country)),t.city&&(e=e.ilike("city",`%${t.city}%`)),t.budgetRange){const l={"До 5000$ на рік":{min:0,max:5e3},"5000-10000$ на рік":{min:5e3,max:1e4},"10000-20000$ на рік":{min:1e4,max:2e4},"20000-30000$ на рік":{min:2e4,max:3e4},"Понад 30000$ на рік":{min:3e4,max:999999}}[t.budgetRange];l&&(e=e.gte("tuition_fee_min",l.min).lte("tuition_fee_max",l.max))}const r={rating:"rating",name:"name",country:"country",tuition_fee:"tuition_fee_min"};t.sortBy&&r[t.sortBy]?e=e.order(r[t.sortBy],{ascending:t.sortBy==="name"||t.sortBy==="country"}):e=e.order("rating",{ascending:!1});const{data:a,error:g}=await e;if(g)throw g;u(a||[])}catch(e){console.error("Помилка пошуку університетів:",e),i(e.message)}finally{n(!1)}},[]),v=async t=>{n(!0),i(null);try{const{data:e,error:r}=await s.from("universities").select("*").ilike("name",`%${t}%`).order("name");if(r)throw r;u(e||[])}catch(e){console.error("Помилка пошуку по спеціальності:",e),i(e.message)}finally{n(!1)}},w=async t=>{n(!0),i(null);try{const{data:e,error:r}=await s.from("universities").select("*").eq("country",t).order("name");if(r)throw r;u(e||[])}catch(e){console.error("Помилка отримання університетів по країні:",e),i(e.message)}finally{n(!1)}},p=async()=>{try{const{data:t,error:e}=await s.from("universities").select("country").order("country");if(e)throw e;return[...new Set(t.map(a=>a.country))]}catch(t){return console.error("Помилка отримання країн:",t),[]}},x=async()=>[];return o.useEffect(()=>{y.length===0&&!c&&f()},[]),{universities:y,loading:c,error:m,fetchUniversities:f,searchUniversities:d,searchBySpecialty:v,getUniversitiesByCountry:w,getCountries:p,getSpecialties:x}}export{B as u};
