import{a as o}from"./chunk-EF7DTUVF-DePYFLeH.js";import{s}from"./supabase-lbAFZqEE.js";function B(){const[a,u]=o.useState([]),[c,r]=o.useState(!1),[m,i]=o.useState(null),l=o.useCallback(async()=>{if(!c){r(!0),i(null);try{const{data:t,error:e}=await s.from("universities").select("*").order("name");if(e)throw e;u(t||[])}catch(t){console.error("Помилка завантаження університетів:",t),i(t.message)}finally{r(!1)}}},[]),d=o.useCallback(async t=>{r(!0),i(null);try{let e=s.from("universities").select("*");if(t.query&&(e=e.ilike("name",`%${t.query}%`)),t.country&&(e=e.eq("country",t.country)),t.city&&(e=e.ilike("city",`%${t.city}%`)),t.budgetRange){const f={"До 5000$ на рік":{min:0,max:5e3},"5000-10000$ на рік":{min:5e3,max:1e4},"10000-20000$ на рік":{min:1e4,max:2e4},"20000-30000$ на рік":{min:2e4,max:3e4},"Понад 30000$ на рік":{min:3e4,max:999999}}[t.budgetRange];f&&(e=e.gte("tuition_fee_min",f.min).lte("tuition_fee_max",f.max))}const n={rating:"rating",name:"name",country:"country",tuition_fee:"tuition_fee_min"};t.sortBy&&n[t.sortBy]?e=e.order(n[t.sortBy],{ascending:t.sortBy==="name"||t.sortBy==="country"}):e=e.order("rating",{ascending:!1});const{data:y,error:g}=await e;if(g)throw g;u(y||[])}catch(e){console.error("Помилка пошуку університетів:",e),i(e.message)}finally{r(!1)}},[]),v=async t=>{r(!0),i(null);try{const{data:e,error:n}=await s.from("universities").select("*").ilike("name",`%${t}%`).order("name");if(n)throw n;u(e||[])}catch(e){console.error("Помилка пошуку по спеціальності:",e),i(e.message)}finally{r(!1)}},w=async t=>{r(!0),i(null);try{const{data:e,error:n}=await s.from("universities").select("*").eq("country",t).order("name");if(n)throw n;u(e||[])}catch(e){console.error("Помилка отримання університетів по країні:",e),i(e.message)}finally{r(!1)}},p=async()=>{try{const{data:t,error:e}=await s.from("universities").select("country").order("country");if(e)throw e;return[...new Set(t.map(y=>y.country))]}catch(t){return console.error("Помилка отримання країн:",t),[]}},x=async()=>[];return o.useEffect(()=>{a.length===0&&!c&&l()},[a.length,c,l]),{universities:a,loading:c,error:m,fetchUniversities:l,searchUniversities:d,searchBySpecialty:v,getUniversitiesByCountry:w,getCountries:p,getSpecialties:x}}export{B as u};
